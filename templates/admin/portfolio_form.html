{% extends "base.html" %}
{% block title %}{% if project %}Loyihani Tahrirlash{% else %}Yangi Loyiha{% endif %} - SmartBot.uz{% endblock %}

{% block content %}
<div class="container py-4" style="max-width: 800px;">
  <!-- Header -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <h2 class="text-white mb-1">
            <i class="fas fa-{% if project %}edit{% else %}plus{% endif %} me-2 text-primary"></i>
            {% if project %}Loyihani Tahrirlash{% else %}Yangi Loyiha Qo'shish{% endif %}
          </h2>
        </div>
        <a href="{{ url_for('admin_portfolio') }}" class="btn btn-outline-light">
          <i class="fas fa-arrow-left me-1"></i>Orqaga
        </a>
      </div>
    </div>
  </div>

  <!-- Flash Messages -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, msg in messages %}
        <div class="alert alert-{{ 'danger' if category=='error' else 'success' }} alert-dismissible fade show" role="alert">
          {{ msg }}
          <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  <!-- Form -->
  <div class="row">
    <div class="col-12">
      <div class="card" style="background-color: rgba(52, 58, 64, 0.9); border: 1px solid rgba(255,255,255,0.1);">
        <div class="card-body">
          <form method="POST">
            <div class="row g-3">
              <div class="col-md-8">
                <label for="title" class="form-label text-white">Loyiha nomi *</label>
                <input type="text" 
                       id="title"
                       name="title" 
                       class="form-control bg-dark border-0 text-white" 
                       placeholder="Masalan: E-commerce Bot"
                       value="{% if project %}{{ project.title }}{% endif %}"
                       required>
              </div>
              
              <div class="col-md-4">
                <label for="category" class="form-label text-white">Kategoriya *</label>
                <select id="category"
                        name="category" 
                        class="form-select bg-dark border-0 text-white" 
                        required>
                  <option value="">Kategoriyani tanlang</option>
                  <option value="bot" {% if project and project.category == 'bot' %}selected{% endif %}>Telegram Bot</option>
                  <option value="web" {% if project and project.category == 'web' %}selected{% endif %}>Web Sayt</option>
                  <option value="mobile" {% if project and project.category == 'mobile' %}selected{% endif %}>Mobile App</option>
                  <option value="automation" {% if project and project.category == 'automation' %}selected{% endif %}>Avtomatlashtirish</option>
                  <option value="ai" {% if project and project.category == 'ai' %}selected{% endif %}>AI/ChatBot</option>
                </select>
              </div>
              
              <div class="col-12">
                <label for="description" class="form-label text-white">Tavsif *</label>
                <textarea id="description"
                          name="description" 
                          class="form-control bg-dark border-0 text-white" 
                          rows="4" 
                          placeholder="Loyiha haqida batafsil ma'lumot yozing..."
                          required>{% if project %}{{ project.description }}{% endif %}</textarea>
              </div>
              
              <div class="col-md-6">
                <label for="image" class="form-label text-white">Rasm fayl nomi</label>
                <input type="text" 
                       id="image"
                       name="image" 
                       class="form-control bg-dark border-0 text-white" 
                       placeholder="portfolio-1.jpg"
                       value="{% if project %}{{ project.image }}{% endif %}">
                <small class="text-white-50">
                  Fayl nomini kiriting (static/images papkasida bo'lishi kerak)
                </small>
              </div>
              
              <div class="col-md-6">
                <label for="tags" class="form-label text-white">Teglar</label>
                <input type="text" 
                       id="tags"
                       name="tags" 
                       class="form-control bg-dark border-0 text-white" 
                       placeholder="Telegram, E-commerce, Bot"
                       value="{% if project %}{{ project.tags_str }}{% endif %}">
                <small class="text-white-50">
                  Vergul bilan ajrating: Telegram, Python, API
                </small>
              </div>
              
              <div class="col-12">
                <hr class="my-4" style="border-color: #495057;">
                <div class="d-flex gap-2">
                  <button type="submit" class="btn btn-success">
                    <i class="fas fa-save me-1"></i>
                    {% if project %}Yangilash{% else %}Qo'shish{% endif %}
                  </button>
                  <a href="{{ url_for('admin_portfolio') }}" class="btn btn-secondary">
                    <i class="fas fa-times me-1"></i>Bekor qilish
                  </a>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.form-control:focus, .form-select:focus {
  background-color: #495057 !important;
  border-color: #007bff !important;
  color: white !important;
  box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25) !important;
}

.form-control::placeholder {
  color: #adb5bd !important;
}

.form-select option {
  background-color: #343a40;
  color: white;
}
</style>
{% endblock %}